# Filenames
This directory contains intermediate results from analysis. 
## Basic simulations

Simulation output files are of the general form

```
<SIMULATION_STRING>.EXT
```
where for MSprime simulations, the `<SIMULATION_STRING>` is of the form

```
msprime-<SIMULATION_VARIABLES>-<OTHER_PARAMS>
```

and the file extension .EXT may be e.g. *.nex* for a nexus file of trees, *.vpos* for a list of variant positions, *.hap* for a haplotype matrix of variants (rows) by samples (columns), *.hdf5* for an hdf5 file, etc etc.

Within the SIMULATION_STRING:

* `<SIMULATION_VARIABLES>` indicates the variables used to adjust the simulation. For basic MSprime simulations, we set 
	* sample size (*n*)
	* N<sub>e</sub> (*Ne*)
	* sequence length (*l*) in base pairs
	* recombination rate (*rho*) per base per generation
	* mutation rate (*mu*) per base per generation. 

	These are separated by underscores, e.g. the filename might contain a string such as
`n100_Ne10000_l100000_rho0.0000001_mu0.0000001`

* `<OTHER_PARAMS>` contains other parameters, again separated by underscores. These can include:
	* a random number seed (*gs*) for the genealogical part of the simulation 
	* a random number seed (*ms*) for the mutational part of the simulation
	* (optionally for files which have been processed into sequence data, such as *.hap* files) a sequencing error rate (*err*)
	* (optionally) the maximum or highest sample id (*max*) represented in this file, if the file contains only a subsample of the original data. For example, if the original simulation contained 100 samples, a file with *max10* will contain only samples 1 to 10 (corresponding to samples labelled 0..9 if zero-based indexing is used).

   A filename might thus contain a string such as `gs123_ms234_err0.001_max10`.

An hdf5 file from an msprime simulation might thus be saved under a filename such as

```
msprime-n100_Ne10000_l100000_rho0.00000002_mu0.00000002-gs123_ms234.hdf5
```

and a variant matrix created from the same simulation with error 0.001 containing only samples 1..12 might have a name such as

```
msprime-n100_Ne10000_l100000_rho0.00000002_mu0.00000002-gs123_ms234_err0.001_max12.hap
```
	
	
## Inference methods

Several algorithms can be used to infer trees or ARGs from data generated by these MSprime simulations. We use the programs [fastARG](https://github.com/lh3/fastARG), [ARGweaver](http://mdrasmus.github.io/argweaver/doc/), and our own inference program based on the Li & Stevens method, which we could call _LiStevensMSprime_. 

The files created by inference methods take the general form

```
<PREFIX>+<SIMULATION_STRING>+<SUFFIX>.EXT
```

Where `<SIMULATION_STRING>` is as defined above, a string starting with *msprime...*, and `<SUFFIX>` is a list of inference-specific params containing e.g. the random number seed(s) used.

#### fastARG

Files created from fastARG have the prefix *fastarg* and the suffix contains the random number seed used, denoted *fs*. For example, running fastARG on the MSprime *.hap* file mentioned previously, with the random number seed 54321 should result in an [fastARG output file](https://github.com/lh3/fastARG#output-format) named

```
fastarg+msprime-n100_Ne10000_l100000_rho0.00000002_mu0.00000002-gs123_ms234_err0.001_max12+fs54321.farg
```
The equivalent file of trees would have the same base name but a *.nex* extension.

#### ARGweaver

Files created from ARGweaver have the prefix `aweaver`. The suffix contains the random number seed (*ws*), and may also contain the ARGweaver iteration number (*i.*). The ARGweaver default setting is to output a sample ARG every 10 iterations, over a total of 1000 generations, to give 100 ARG estimates, giving iteration numbers *i.0*, *i.10*, *i.20*, etc. The population parameters passed to argweaver (Ne, mutation rate, recombination rate) are assumed to be the same as used in the original MSprime simulation which has generated the data, and are therefore omitted from the SUFFIX string. The SUFFIX string may thus look something like `ws123_i.10`.  

By default, argweaver outputs files in the *.smc* format, giving filenames that look like

`aweaver+<SIMULATION_STRING>+ws123i.10.smc`

ARGweaver *.smc* files can be relatively simply converted into a set of trees in *.nex* format. An example, with an argweaver seed of 9999 would be

```
aweaver+msprime-n100_Ne10000_l100000_rho0.00000002_mu0.00000002-gs123_ms234_err0.001_max12+ws9999_i.10.nex
```

Note that the sample ARGs have different likelihoods - these are given by an associated `.stats` file (which does not have iteration numbers attached), the equivalent example being

```
aweaver+msprime-n100_Ne10000_l100000_rho0.00000002_mu0.00000002-gs123_ms234_err0.001_max12+ws9999.stats
```


#### MSprime inference using the Li & Stevens algorithm

Our own inference method is given the shorthand prefix `msinfer`. As with ARGweaver, the expected recombination rate is taken to be the same as in the original simulation. It is possible that no suffix string will be needed: an example infered hdf5 file could be

```
msinfer+msprime-n100_Ne10000_l100000_rho0.00000002_mu0.00000002-gs123_ms234_err0.001_max12+.hdf5
```

For comparing with other inference methods, we may want to restrict files to output only a subset of samples. The SUFFIX in this case will contain max*N*, for samples 1..N, so that a file of the form

```
msinfer+msprime-n100_Ne10000_l100000_rho0.00000002_mu0.00000002-gs123_ms234_err0.001+max12.nex
```

will contain inferred trees for samples 0..11 of the 100 (haploid) genomes which have been output from the msprime simulation.