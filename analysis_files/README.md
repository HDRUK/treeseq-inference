# Filenames
This directory contains intermediate results from analysis. 
## Basic simulations

Simulation output files are of the general form

```
<SIMULATION_STRING>.EXT
```
where `<SIMULATION_STRING>` is of the form

```
<PREFIX>-<PARAMS>-<SEED>
```

The file extension .EXT may be e.g. *.nex* for a nexus file, *.vpos* for a list of variant positions, *.hdf5* for an hdf5 file, etc etc. Allowable PREFIXes are 'msprime' or 'msNNsub', giving filenames as follows:

* `msprime-<PARAMS...>-<SEED>.EXT` contains results from an MSprime simulation (for *PARAMS...* see below). *SEED* is a number used as the initial random number seed - if it contains an underscore, this denotes two random seeds, the first used for the ancestry simulation and the second for the addition of mutations.

* `msNNsub-<PARAMS...>-<SEED>.EXT` indicates the same MSprime simulation above, but with results reduced to only the first `NN` samples, e.g. `ms10sub-<PARAMS...>-123_456.hdf5` contains only the first 10 sequences of the whole simulation. 

* `<PARAMS...>` indicates the parameters used for the simulation. For basic MSprime simulations, we set sample size (n), N<sub>e</sub>, sequence length (l) in base pairs, recombination rate (rc) per base per generation, and mutation rate (mu) per base per generation. These are encoded in the filename, separated by underscores. E.g.
`n100_Ne10000_l100000_rc0.0000001_mu0.0000001`. The trees created from an msprime simulation might thus be saved under a filename like

	```
	ms10sub-n100_Ne10000_l100000_rc0.00000002_mu0.00000002-123_456.nex
	```
	
## Inference methods

Several algorithms can be used to infer trees or ARGs from data generated by these MSprime simulations. We use the programs [fastARG](https://github.com/lh3/fastARG), [ARGweaver](http://mdrasmus.github.io/argweaver/doc/), and our own inference program based on the Li & Stevens method, which we could call _LiStevensMSprime_. 

The files created by inference methods take the general form

```
<PREFIX>+<SIMULATION_STRING>+<SUFFIX>.EXT
```

Where `<SIMULATION_STRING>` is as defined above: a string starting with *msprime...* or *msXXsub...*, and `<SUFFIX>` is a list of inference-specific params, containing e.g. the random number seed(s) used.

#### fastARG

Files created from fastARG have the prefix *fastarg* and a suffix of the random number seed used. For example, running fastARG on the MSprime simulation mentioned previously, with the random number seed 54321 should result in an [fastARG output file](https://github.com/lh3/fastARG#output-format) named

```
fastarg+ms10sub-n100_Ne10000_l100000_rc0.00000002_mu0.00000002-123_456+54321.farg
```
or a set of trees with the same base name but with a *.nex* extension.

#### ARGweaver

Files created from ARGweaver have the prefix `aweaver`. The suffix contains the (integer) random number seed, and may also contain the ARGweaver iteration number, separated from the seed by a period.The ARGweaver default setting is to output a sample ARG every 10 iterations, over a total of 1000 generations, to give 100 ARG estimates, giving iteration numbers *.0*, *.10*, *.20*, etc. The population parameters passed to argweaver (Ne, mutation rate, recombination rate) are assumed to be the same as used in the original MSprime simulation which has generated the data. 

By default, argweaver outputs files in the *.smc* format, giving filenames in the form

`aweaver+<SIMULATION_STRING>+<SEED>.XX.smc`

Which can be converted into a set of trees in *.nex* format. An example, with an argweaver seed of 9999 would be

```
aweaver+ms10sub-n100_Ne10000_l100000_rc0.00000002_mu0.00000002-123_456+9999.10.nex
```

Note that the sample ARGs have different likelihoods - these are given by an associated `.stats` file, in this case

```
aweaver+ms10sub-n100_Ne10000_l100000_rc0.00000002_mu0.00000002-123_456+9999.stats
```


#### MSprime inference using the Li & Stevens algorithm

Our own inference method is given the shorthand prefix `lsinfer`. For files which infer the whole ARG but then simplify the result down to a subset of the first `NN` samples, we use the prefix `lsNNsub`, followed by the random seed used. An example, with random seed 8888 might be

```
ls10sub+msprime-n100_Ne10000_l100000_rc0.00000002_mu0.00000002-123_456
+8888.nex
```

