# Filenames
This directory contains intermediate results from analysis. The output files have the following prefixes

## Basic simulations

`msprime-<PARAMS...>-<SEED>.EXT` contains results from an MSprime simulation. For `<PARAMS...>` see below. `<SEED>` is a 6 digit number used as the initial random number seed. The file extension `.EXT` may be e.g. `.nex` for a nexus file, `.hdf5` for an hdf5 file, etc etc. 

`msNNsub-<PARAMS...>-<SEED>.EXT` Identical to the MSprime simulation above, but with results reduced to only the first `NN` samples, e.g. `ms10sub-<PARAMS...>-123456.hdf5` contains only the first 10 sequences of the whole simulation. 

### `<params...>`

For basic MSprime simulations, we set sample size (n), N<sub>e</sub>, sequence length (l) in base pairs, recombination rate (rc) per base per generation, and mutation rate (mu) per base per generation. These are encoded in the filename, separated by underscores. E.g.
`n100_Ne10000_l100000_rc0.0000001_mu0.0000001`. The trees created from an msprime simulation might thus be saved under a filename like

```
msprime-n100_Ne10000_l100000_rc0.00000002_mu0.00000002-123456.nex
```
## Inference methods

Several algorithms can be used to infer trees or ARGs from data generated by these MSprime simulations. We use the programs _fastARG_, _ARGweaver_, and our own inference program based on the Li & Stevens method, which we could call _LiStevensMSprime_. 

#### Fastarg

Files created from fastARG are labelled as follows:

`fastarg-<SEED>+<msprime_filename>.ext`

Where `<msprime_filename>` is an `msprime...` or `msXXsub...` string. For example, running fastARG on the MSprime simulation mentioned previously would result in an intermediate .fa file 

```
fastarg-123123+ms10sub-n100_Ne10000_l100000_rc0.00000002_mu0.00000002-123456.nex
```
#### ARGweaver

Files created from ARGweaver are of the same form, but with a prefix of `aweaver`, or (more commonly), `aw.XXXX`, where `XXXX` is the iteration number. We use the ARGweaver defaults, outputting a sample ARG every 10 iterations, over a total of 1000 generations, to give 100 ARG estimates. The population parameters passed to argweaver (Ne, mutation rate, recombination rate) are assumed to be the same as used in the original MSprime simulation which has generated the data. By default, argweaver outputs files in the `.smc` format, giving filenames in the form

`aw.XXXX-<SEED>+<msprime_filename>.smc`

Which can be converted into nexus format, giving a filename such as the following example

```
aw.10-123123+ms10sub-n100_Ne10000_l100000_rc0.00000002_mu0.00000002-123456.nex
```

Note that the sample ARGs have different likelihoods - these are given by an equivalent `.stats` file such as

```
aweaver-123123+ms10sub-n100_Ne10000_l100000_rc0.00000002_mu0.00000002-12345.stats
```


#### MSprime inference using the Li & Stevens algorithm

Our own inference method is given the shorthand prefix `lsinfer`. For files which infer the whole ARG but then simplify the result down to a subset of the first `NN` samples, we use the prefix `lsNNsub`, followed by the random seed used. An example might be

```
ls10sub-654321+msprime-n100_Ne10000_l100000_rc0.00000002_mu0.00000002-123456.nex
```

